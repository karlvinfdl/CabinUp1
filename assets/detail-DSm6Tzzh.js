import"./script-DuONl4hR.js";/* empty css              */const i=(e,n=document)=>n.querySelector(e),g=new URLSearchParams(window.location.search).get("id");if(!g)throw document.body.innerHTML="<h2 style='text-align:center;color:red;'>❌ Aucun logement sélectionné</h2>",new Error("ID manquant dans l’URL !");const h=window.location.hostname==="localhost"?"http://localhost:3001/logements":"/db.json";fetch(h).then(e=>{if(!e.ok)throw new Error(`Erreur ${e.status} : logement non trouvé`);return e.json()}).then(e=>{if(!e||!e.id)throw new Error("Aucun logement correspondant trouvé.");const n=i("#product-image"),o=e.image?.replace(/^(\.\.\/)+/,"../")||"../assets/images/placeholder.jpg";n.src=o,n.alt=e.titre;const c=document.querySelector(".thumbs__detail"),a=document.querySelector("#lightbox-slides");c.innerHTML="",a.innerHTML="",[o,...(e.galerie||[]).map(t=>t.replace(/^(\.\.\/)+/,"../"))].forEach((t,r)=>{if(r>0){const d=document.createElement("div");d.className="thumb__detail",d.innerHTML=`<img src="${t}" alt="${e.titre}">`,d.addEventListener("click",()=>n.src=t),c.appendChild(d)}const s=document.createElement("img");s.src=t,s.alt=e.titre,a.appendChild(s)}),i("#product-title").textContent=e.titre,i("#product-desc p").textContent=e.description,i("#product-price").innerHTML=`${e.prix} € <span class="muted__detail">/ nuit</span>`,i(".meta__detail").innerHTML=`<span>${e.ville}</span> • <span>${e.capacite} pers.</span>`;const u=i(".amen-grid__detail");u.innerHTML=(e.equipements||[]).map(t=>`<div class="amen__detail"><i class="fa-solid fa-check"></i><span>${t}</span></div>`).join(""),p(e.lat,e.lng,12,`${e.titre} — ${e.ville}`),i("#add-to-cart").addEventListener("click",t=>{t.preventDefault();let r=JSON.parse(localStorage.getItem("cart"))||[];if(r.find(s=>s.id===e.id)){alert("⚠️ Ce logement est déjà dans votre panier !");return}r.push({id:e.id,titre:e.titre,ville:e.ville,prix:e.prix,description:e.description,capacite:e.capacite,image:o,galerie:e.galerie,lat:e.lat,lng:e.lng,nights:1,guests:1}),localStorage.setItem("cart",JSON.stringify(r)),alert("✅ Logement ajouté au panier !")})}).catch(e=>{console.error("Erreur lors du chargement du logement :",e),document.body.innerHTML=`<h2 style="color:red;text-align:center;">⚠️ ${e.message}</h2>`});function p(e=45.75,n=4.85,o=12,c="Emplacement du logement"){const a=document.getElementById("map");if(!a||typeof L>"u"){console.warn("⚠️ Leaflet non chargé ou #map introuvable");return}if(a._leaflet_id){console.log("✅ Carte déjà initialisée, on ne la recrée pas.");return}const l=L.map(a).setView([e,n],o);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(l),L.marker([e,n]).addTo(l).bindPopup(`<b>${c}</b>`).openPopup()}window.initMapDetail=p;const m=document.getElementById("toggleAmenities");m&&m.addEventListener("click",()=>{const e=document.getElementById("moreAmenities");e.classList.toggle("hidden__detail"),m.textContent=e.classList.contains("hidden__detail")?"Voir plus":"Voir moins"});
