import"./script-BYnXnCnG.js";/* empty css              */const i=(e,n=document)=>n.querySelector(e),p=new URLSearchParams(window.location.search).get("id");if(!p)throw document.body.innerHTML="<h2 style='text-align:center;color:red;'>❌ Aucun logement sélectionné</h2>",new Error("ID manquant dans l’URL !");fetch(`${BASE_URL}/logements/${p}`).then(e=>{if(!e.ok)throw new Error(`Erreur ${e.status} : logement non trouvé`);return e.json()}).then(e=>{if(!e||!e.id)throw new Error("Aucun logement correspondant trouvé.");const n=i("#product-image"),r=e.image?.replace(/^(\.\.\/)+/,"../")||"../assets/images/placeholder.jpg";n.src=r,n.alt=e.titre;const s=document.querySelector(".thumbs__detail"),a=document.querySelector("#lightbox-slides");s.innerHTML="",a.innerHTML="",[r,...(e.galerie||[]).map(t=>t.replace(/^(\.\.\/)+/,"../"))].forEach((t,o)=>{if(o>0){const d=document.createElement("div");d.className="thumb__detail",d.innerHTML=`<img src="${t}" alt="${e.titre}">`,d.addEventListener("click",()=>n.src=t),s.appendChild(d)}const c=document.createElement("img");c.src=t,c.alt=e.titre,a.appendChild(c)}),i("#product-title").textContent=e.titre,i("#product-desc p").textContent=e.description,i("#product-price").innerHTML=`${e.prix} € <span class="muted__detail">/ nuit</span>`,i(".meta__detail").innerHTML=`<span>${e.ville}</span> • <span>${e.capacite} pers.</span>`;const g=i(".amen-grid__detail");g.innerHTML=(e.equipements||[]).map(t=>`<div class="amen__detail"><i class="fa-solid fa-check"></i><span>${t}</span></div>`).join(""),u(e.lat,e.lng,12,`${e.titre} — ${e.ville}`),i("#add-to-cart").addEventListener("click",t=>{t.preventDefault();let o=JSON.parse(localStorage.getItem("cart"))||[];if(o.find(c=>c.id===e.id)){alert("⚠️ Ce logement est déjà dans votre panier !");return}o.push({id:e.id,titre:e.titre,ville:e.ville,prix:e.prix,description:e.description,capacite:e.capacite,image:r,galerie:e.galerie,lat:e.lat,lng:e.lng,nights:1,guests:1}),localStorage.setItem("cart",JSON.stringify(o)),alert("✅ Logement ajouté au panier !")})}).catch(e=>{console.error("Erreur lors du chargement du logement :",e),document.body.innerHTML=`<h2 style="color:red;text-align:center;">⚠️ ${e.message}</h2>`});function u(e=45.75,n=4.85,r=12,s="Emplacement du logement"){const a=document.getElementById("map");if(!a||typeof L>"u"){console.warn("⚠️ Leaflet non chargé ou #map introuvable");return}if(a._leaflet_id){console.log("✅ Carte déjà initialisée, on ne la recrée pas.");return}const l=L.map(a).setView([e,n],r);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(l),L.marker([e,n]).addTo(l).bindPopup(`<b>${s}</b>`).openPopup()}window.initMapDetail=u;const m=document.getElementById("toggleAmenities");m&&m.addEventListener("click",()=>{const e=document.getElementById("moreAmenities");e.classList.toggle("hidden__detail"),m.textContent=e.classList.contains("hidden__detail")?"Voir plus":"Voir moins"});
